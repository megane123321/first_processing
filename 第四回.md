# 初めてのprocessing 第四回 クラスを使ってみる

## クラスとは
クラスとは、複数の変数と関数をまとめたものである。クラスではまとめられた変数をフィールド、関数をメソッドと呼ぶ。

processingでは標準で利用できるクラスがたくさん用意されている。  
例として、
* Stringクラス
* ArrayListクラス
* PImageクラス
* PGraphicsクラス
などを挙げることができる。

## インスタンスについて
クラスを扱うには、インスタンスと呼ばれるクラスの実体を作る必要がある。  
なぜなら、クラスというのはあくまで型のような働きをするのであって、実際に値を持っているわけではないからである。

processingでの`"abc"`のような文字列リテラルは全て、StringクラスのインスタンスとしてふるまうためStringクラスを使用する際はあまり気にしていなかったと思う。

```java
void setup(){
  String str="abc";//Stringクラスの変数に"abc"のインスタンスを代入している
}
```
図1. Stringのメソッドが使用できる

インスタンスを作成するためには`new クラス名(引数)`のように書かなければならない。配列も一種のクラスである。
変数はインスタンスを共有しており、一方で変更されるともう一方も変化してしまう。

そのため、インスタンスを共有させないためには個別にnewする必要がある。
[第二回の図15](第二回.md#図15)のような現象が起こるのは二つの変数が同一のインスタンスを見ていたからである。

フィールドやメソッドにアクセスするには`変数名.フィールド名`や、`変数名.メソッド名(引数)`とする。この時、変数にインスタンスが代入されていないときはエラーが出力される。

しかし、インスタンスの情報を必要としない一部のフィールドや関数は、`クラス名.フィールド名`や、`クラス名.メソッド名(引数)`などでもアクセスできる。  
例. `String.format()`、`Integer.MAX_VALUE`

```java
void setup(){
  int max=Integer.MAX_VALUE;//intの最大値を表すフィールド
  String str=String.format("int型の最大値は%dです。",max);//文字列に値を挿入するメソッド
  println(str);
}
```
図2. インスタンス無しでアクセス可能なフィールドやメソッドの例

## Stringクラス
```java
void setup(){
  println("abc".charAt(0));//先頭の文字GET!
}
```
図2. Stringのメソッドが使用できる

文字列定数としてふるまう。定数であるため、中の文字列は変化しない。

```java
void setup(){
  String a="test1";
  String b="test2";
  String c=b;

  b+=a;//ここでbには、bとaが連結した内容の新たなインスタンスが代入されている

  println(b);//test2test1
  println(c);//test2
}
```
図3. 文字列は変化していない


## おまけ(値型と参照型)
今更だが、変数は値を保持している。  
が、それは`int型`などの値型のお話。

今回説明したクラスは参照型である。参照型が変数に保持しているのはインスタンスの場所である。
ここで困るのが等価演算子である。

どういうことかというと、processingの等価演算子の評価基準が、等価であるかではなく等値であるかであるためにインスタンスを比較したときに意図しない動作をすることがあるのである。

前述のとおりクラスの型の変数が持っているのはインスタンスの場所である。そのため、等価であっても別のインスタンスであった場合にfalseが帰ってくるのである。

```java
void setup(){
  String a=new String("test");//同じ内容の別のインスタンスを生成させる
  String b=new String("test");
  println(a==b);//別のインスタンス(場所が違う)であるためfalse
  String c,d;
  c=d="test";
  println(c==d);//同一インスタンス(場所が同じ)であるためtrue
}
```

そのために等価であるかどうかを調べるにはequalsメソッドを用いるとよい。

```java
void setup(){
  String a=new String("test");
  String b=new String("test");
  println(a.equals(b));//等価であるため別のインスタンスでもtrue
}
```
